"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[209],{209:(e,t,n)=>{n.r(t),n.d(t,{createWidget:()=>g});var s=n(378),i=n(206),r=n(173),l=n(401),a=n(329);class o extends s.Component{constructor(e){super(e),this.element=null,this.ref=e=>{var t,n;this.element!==e&&(null!=this.element&&this.resizeObserver.unobserve(this.element),this.element=e,null!=this.element&&(this.resizeObserver.observe(this.element),null===(n=(t=this.props).onResize)||void 0===n||n.call(t,{width:e.clientWidth,height:e.clientHeight})))},this.onResize=([e])=>{var t,n;null===(n=(t=this.props).onResize)||void 0===n||n.call(t,e.contentRect)},this.resizeObserver=new a.Z(this.onResize)}render(){return this.props.children(this.ref)}}var c=n(42);const h="_f",u=s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",height:"100%",width:"100%",fill:"currentColor"},s.createElement("path",{d:"M2,10 2,2 10,2 10,4 4,4 4,10z M22,10 22,2 14,2 14,4 20,4 20,10z M2,14 2,22 10,22 10,20 4,20 4,14z M22,14 22,22 14,22 14,20 20,20 20,14z"})),m=s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",height:"100%",width:"100%",fill:"currentColor"},s.createElement("path",{d:"M2,8 8,8 8,2 10,2 10,10 2,10z M2,16 2,14 10,14 10,22 8,22 8,16 M16,2 14,2 14,10 22,10 22,8 16,8 M22,16 22,14 14,14 14,22 16,22 16,16"})),d=s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",height:"100%",width:"100%",fill:"currentColor"},s.createElement("path",{d:"M2,2 2,22 4,22 4,2 M6,6 6,18 8,18 8,6 M16,6 16,18 18,18 18,6 M20,2 20,22 22,22 22,2z"})),w=s.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",height:"100%",width:"100%",fill:"currentColor"},s.createElement("path",{d:"M6,2 6,22 8,22 8,2 M2,6 2,18 4,18 4,6 M20,6 20,18 22,18 22,6 M16,2 16,22 18,22 18,2z"}));class v extends s.Component{constructor(e){var t,n;super(e),this.allowFullwidth=null===(t=this.props.fullwidth)||void 0===t||t,this.allowFullscreen=null===(n=this.props.fullscreen)||void 0===n||n,this.contentRef=s.createRef(),this.onFullscreenChange=e=>{var t,n;if(e.target===this.contentRef.current){const e=null!=document.fullscreenElement;null===(n=(t=this.props).onModeChange)||void 0===n||n.call(t,e?"fullscreen":this.state.mode),this.setState({fullscreen:e})}},this.requestExitFullscreen=()=>{document.exitFullscreen()},this.requestFullscreen=()=>{var e;null===(e=this.contentRef.current)||void 0===e||e.requestFullscreen()},this.state={mode:"embedded",fullscreen:!1,fullscreenEnabled:!1}}componentDidMount(){document.addEventListener("fullscreenchange",this.onFullscreenChange),this.setState({fullscreenEnabled:window.document.fullscreenEnabled})}componentWillUnmount(){document.removeEventListener("fullscreenchange",this.onFullscreenChange)}render(){const e=[];return this.allowFullwidth&&!this.state.fullscreen&&("embedded"===this.state.mode?e.push(s.createElement("button",{key:"fullwidth",className:c(h,"_g"),title:"Cinema mode",onClick:()=>this.setState({mode:"fullwidth"})},d)):e.push(s.createElement("button",{key:"embedded",className:c(h,"_g"),title:"Default view",onClick:()=>this.setState({mode:"embedded"})},w))),this.allowFullscreen&&this.state.fullscreenEnabled&&(this.state.fullscreen?e.push(s.createElement("button",{key:"fullscreen",className:h,title:"Exit full screen",onClick:this.requestExitFullscreen},m)):e.push(s.createElement("button",{key:"fullscreen",className:h,title:"Full screen",onClick:this.requestFullscreen},u))),s.createElement("div",{className:c("_b","fullwidth"===this.state.mode&&"_c")},e.length>0&&s.createElement("div",{className:"_d"},e),s.createElement("div",{className:"_e"}),s.createElement("div",{ref:(0,i.Z)(this.contentRef,this.props.contentRef)},this.props.children(this.state.fullscreen?"fullscreen":this.state.mode)))}}class p{constructor(){this.movements=new l.xQ;let e=!1;const t=new l.xQ;t.pipe((0,l.Gv)()).pipe((0,l.UI)((([e,t])=>{if(null!=e&&null!=t)return{x:t.x-e.x,y:t.y-e.y}}))).pipe((0,l.xb)()).subscribe((e=>this.movements.next(e)));const n=n=>{0===n.button&&(e=!0,t.next({x:n.clientX,y:n.clientY}))},s=()=>{e&&(e=!1,t.next(void 0))},i=n=>{e&&t.next({x:n.clientX,y:n.clientY})};let r=null;this.ref=e=>{r!==e&&(null!=r&&(r.removeEventListener("mousedown",n),window.removeEventListener("mouseup",s),window.removeEventListener("mousemove",i)),r=e,null!=r&&(r.addEventListener("mousedown",n),window.addEventListener("mouseup",s),window.addEventListener("mousemove",i)))}}}function f(e,t={}){const n=(new r.u9r).setFromPoints([new r.Pa4(1,1,0),new r.Pa4(-1,1,0),new r.Pa4(-1,-1,0),new r.Pa4(1,-1,0),new r.Pa4(1,1,0)]),s=new r.nls({color:e,transparent:!0,opacity:.4}),i=new r.nls({color:e}),l=(new r.u9r).setFromPoints([new r.Pa4(0,0,0),new r.Pa4(0,0,200)]),a=new r._12(2,2),o=new r.vBJ({color:e,side:r.ehD,transparent:!0,opacity:.1,depthWrite:!1,depthTest:!1}),c=new r.ZAu;return c.add(new r.x12(n,s),new r.x12(l,i),new r.Kj0(a,o)),Object.assign(c.rotation,t),c}class x{constructor(e,t){this.scene=new r.xsS,this.cube=new r.ZAu,this.camera=new r.cPb(45,16/9,1,100),this.renderer=new r.CP7({canvas:e,antialias:!0}),this.renderer.setClearColor(16777215,0),this.cube.add(f(16711680,{y:Math.PI/2}),f(65280,{x:-Math.PI/2}),f(255)),this.cube.setRotationFromQuaternion(t),this.camera.position.z=4,this.scene.add(this.cube)}getQuaternion(){return this.cube.quaternion}getMatrix(){return this.cube.matrix}rotate(e){this.cube.applyQuaternion(e),this.cube.quaternion.normalize()}update(){this.renderer.render(this.scene,this.camera)}resize(e,t){this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}}class E extends s.Component{constructor(e){super(e),this.tracker=new p,this.canvasRef=s.createRef(),this.frameContentRef=s.createRef(),this.viewResized=!1,this.onFrameResize=e=>{this.setState({canvasDimension:e}),this.viewResized=!0},this.onFrameModeChange=e=>{this.setState({frameMode:e}),this.viewResized=!0},this.state={cursor:"grab",canvasDimension:{width:1280,height:720}}}componentDidMount(){const e=this.frameContentRef.current,t=this.canvasRef.current;if(null==e||null==t)return;const n=new x(t,new r._fP(.1,-.1,0,.98));n.resize(e.clientWidth,9*e.clientWidth/16),this.tracker.movements.subscribe((e=>{if(this.setState({cursor:null==e?"grab":"grabbing"}),null!=e){const{x:t,y:s}=e,i=function(e,t){const{x:n,y:s,z:i}=e.normalize(),l=Math.sin(t/2);return new r._fP(n*l,s*l,i*l,Math.cos(t/2))}(new r.Pa4(s,t,0),Math.sqrt(t*t+s*s)/60);n.rotate(i),this.setState({quaternion:n.getQuaternion(),matrix:n.getMatrix()})}})),this.setState({quaternion:n.getQuaternion(),matrix:n.getMatrix()}),this.cubeView=n}componentDidUpdate(){if(null!=this.cubeView){if(this.viewResized){const{frameMode:e,canvasDimension:{width:t,height:n}}=this.state;this.cubeView.resize(t,"fullscreen"===e?n:9*t/16),this.viewResized=!1}this.cubeView.update()}}renderMatrix(e){return s.createElement("pre",{className:"R"},null==e?"...":[0,1,2].map((t=>s.createElement("div",{key:t},e.elements.slice(4*t,4*t+3).map((e=>e.toFixed(4).padStart(7))).join(",")+","))))}render(){const{cursor:e,quaternion:t,matrix:n}=this.state;return s.createElement("div",null,s.createElement("h1",{className:"N"},"Rotation visualization"),s.createElement(o,{onResize:this.onFrameResize},(t=>s.createElement(v,{contentRef:(0,i.Z)(this.frameContentRef,t),onModeChange:this.onFrameModeChange},(t=>s.createElement(s.Fragment,null,s.createElement("canvas",{ref:(0,i.Z)(this.canvasRef,this.tracker.ref),className:"O",style:{cursor:e}}),"fullscreen"===t&&s.createElement("div",{className:"Q"},s.createElement("h2",null,"Rotation"),this.renderMatrix(n))))))),s.createElement("div",{className:"P N"},s.createElement("h2",null,"Quaternion"),s.createElement("pre",{className:"R"},null==t?"...":t.toArray().map((e=>e.toFixed(4).padStart(7))).join(",")),s.createElement("h2",null,"Rotation matrix"),this.renderMatrix(n)))}}function g(){return s.createElement(E,null)}}}]);